<!DOCTYPE html>
<html>
<head>
    <title>Pi Surveillance</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="mobile-container">
        <header>
            <h1><i class="fas fa-camera"></i> Pi Surveillance</h1>
        </header>
        
        <div class="video-container">
            <img src="{{ url_for('video_feed') }}" id="video-feed">
        </div>
        
        <div class="controls">
            <form method="POST" action="/control">
                <button type="submit" name="action" value="start" class="btn-record">
                    <i class="fas fa-video"></i> Record
                </button>
                <button type="submit" name="action" value="stop" class="btn-stop">
                    <i class="fas fa-stop"></i> Stop
                </button>
                <button type="submit" name="action" value="capture" class="btn-capture">
                    <i class="fas fa-camera"></i> Snap
                </button>
            </form>
        </div>
        
        <div class="status-bar">
            <span id="connection-status"><i class="fas fa-wifi"></i> Connected</span>
            <span id="recording-status"><i class="far fa-circle"></i> Idle</span>
        </div>
    </div>
    
    <script>
        // Update recording status
        function checkRecordingStatus() {
            fetch('/recording_status')
                .then(response => response.json())
                .then(data => {
                    const statusElement = document.getElementById('recording-status');
                    if (data.recording) {
                        statusElement.innerHTML = '<i class="fas fa-circle" style="color:red"></i> Recording';
                    } else {
                        statusElement.innerHTML = '<i class="far fa-circle"></i> Idle';
                    }
                });
        }
        
        // Check status every 2 seconds
        setInterval(checkRecordingStatus, 2000);
        
        // Fullscreen video on click
        document.getElementById('video-feed').addEventListener('click', function() {
            this.requestFullscreen().catch(err => {
                console.log('Fullscreen error:', err);
            });
        });
    </script>
</body>
</html>